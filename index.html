<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Stacked Timelines</title>
  <style>
    :root {
     
      --primary-color-1a: #1b998a4d; /* Accessible green */
      --primary-color-1b: #1b998aaa; /* Accessible green */
      --primary-color-1c: #1b998ade; /* Accessible green */
      --primary-color-1d: #1B998B; /* Accessible green */
      --primary-color-1: #1B998B;
      --primary-color-2: #E63946; /* Accessible red */
      --primary-color-3: #457B9D; /* Accessible blue */
      --primary-color-3a: #457B9D;
      --primary-color-3b:rgba(69, 123, 157, 0.718); /* Accessible blue */
      --primary-color-4: #F4A261; /* Accessible orange */
      --secondary-color: #f9f9f9;
      --popup-bg: white;
      --popup-border: #ddd;
      --text-color: #978e8e;
      --hover-shadow: rgba(0, 0, 0, 0.2);
    }
  
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: var(--secondary-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      transform: scale(0.9); /* Scale everything to 80% */
      transform-origin: top left; /* Ensure scaling starts from the top left corner */
    }
  
    .timeline-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 60px; /* Increased gap */
      position: relative;
      padding: 80px;
      width: 90%;
      max-width: 1000px;
      overflow-x: auto;
      white-space: nowrap;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 10px;
      transition: all 0.3s ease;
      z-index: 1;
    }
  
    .timeline-container.foreground {
      z-index: 100;
      transform: scale(1.05);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }
  
    .timeline-container.main {
      background-color: #f0f0f0;
    }
  
    .timeline-line {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 3px;
      background: #ccc;
      z-index: 0;
      transform: translateY(-50%);
    }
  
    .timeline-step {
      position: relative;
      text-align: center;
      cursor: pointer;
      z-index: 1;

      opacity: 1;
      transition: opacity 0.3s ease; /* Smooth transition for opacity */
    }

    .timeline-step.opacity-5 { opacity: 1; }
    .timeline-step.opacity-4 { opacity: 0.75; }
    .timeline-step.opacity-3 { opacity: 0.75; }
    .timeline-step.opacity-2 { opacity: 0.75; }
    .timeline-step.opacity-1 { opacity: 0.75; }

  
    .timeline-step .circle {
      width: 50px; /* Increased size */
      height: 50px; /* Increased size */
      border-radius: 50%;
      margin: 0 auto;
      box-shadow: 0 2px 4px var(--hover-shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 1rem; /* Increased font size */
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      color:black;
    }
  
    .timeline-popup-above,
    .timeline-popup-below {
      position: absolute;
      background: var(--popup-bg);
      border: 1px solid var(--popup-border);
      border-radius: 8px;
      padding: 10px;
      font-size: 0.9rem;
      color: var(--text-color);
      box-shadow: 0 4px 8px var(--hover-shadow);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      text-align: left;
      z-index: 1000; /* Set a high z-index value */
      white-space: normal; /* Allow text to wrap */
      height: auto;
      width: 300px; /* Allow width to adjust based on content */
      max-width: none; /* Remove max-width to prevent cutting off text */
      color: black;
    }

    .timeline-popup-above {
      top: -100%; /* Position above the step */
      left: 50%;
      transform: translateX(-50%);
    }

    .timeline-popup-below {
      top: 100%; /* Position below the step */
      left: 50%;
      transform: translateX(-50%);
    }

    .timeline-step:hover .timeline-popup-above,
    .timeline-step:hover .timeline-popup-below {
      opacity: 1;
      visibility: visible;
    }
  
    .timeline-step.show .timeline-popup-above,
    .timeline-step.show .timeline-popup-below {
      opacity: 1;
      visibility: visible;
    }
  
    .timeline-container.expanded {
      max-height: 1000px;
      opacity: 1;
      transform: scaleY(1);
      transition: all 0.5s ease;
    }
  
    .timeline-container.collapsed {
      max-height: 0;
      opacity: 0;
      transform: scaleY(0);
      overflow: hidden;
      transition: all 0.5s ease;
    }
  
    /* Unique colors for expanded timelines */
    .timeline-container:nth-of-type(3) .circle {
      background: var(--primary-color-1);
    }
  
    .timeline-container:nth-of-type(4) .circle {
      background: var(--primary-color-2);
    }
  
    .timeline-container:nth-of-type(5) .circle {
      background: var(--primary-color-3);
    }
  
    .timeline-container:nth-of-type(6) .circle {
      background: var(--primary-color-4);
    }
  
    /* Responsive Design */
    @media (max-width: 768px) {
      .timeline-container {
        padding: 40px;
        gap: 30px; /* Adjusted for smaller screens */
      }
  
      .timeline-step .circle {
        width: 40px; /* Adjusted size */
        height: 40px; /* Adjusted size */
        font-size: 0.85rem; /* Adjusted font size */
      }
  
      .timeline-popup-above,
      .timeline-popup-below {
        position: absolute;
        background: var(--popup-bg);
        border: 1px solid var(--popup-border);
        border-radius: 8px;
        padding: 40px;
        font-size: 0.5rem;
        color: var(--text-color);
        box-shadow: 0 4px 8px var(--hover-shadow);
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        text-align: left;
        z-index: 1000; /* Set a high z-index value */
        white-space: normal; /* Allow text to wrap */
        height: auto;
        width: auto; /* Adjust width to fit text */
        max-width: 700px; /* Optional: Set a maximum width */
        color: black;
        font-size: 0.8rem;
      } 
    }
    .triangle {
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-top: 20px solid var(--primary-color-3a); /* Changed to border-bottom for upside-down triangle */
      position: absolute;
      top: -30px;
      left: 0%;
      transform: translateX(0);
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgb(71, 57, 57);
      font-weight: bold;
      font-size: 0.8rem;
      color:black;
   }

  .triangle::after {
      content: attr(data-text); /* Use data attribute for text */
      position: absolute;
      top: -50px; /* Adjusted position */
      left: 50%;
      transform: translateX(-50%);
      z-index: 1;
  }

  .image-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-right: 20px; /* Adjust as needed */
}

.image-title {
  text-align: center;
  font-weight: bold;
  margin-bottom: 10px;
}

.timeline-container img {
  width: 100px; /* Adjust as needed */
  height: auto;
  border-radius: 50%; /* Circular border */
  border: 3px solid var(--primary-color-3); /* Adjust border color as needed */
  display: none;
}

.timeline-container.expanded img {
  display: block;
}

.timeline-line {
  position: absolute;
  top: 50%;
  left: 0;
  right: 0;
  height: 3px;
  background: #ccc;
  z-index: 0;
  transform: translateY(-50%);
}

@keyframes pulse {
  0% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

.timeline-container.main .timeline-step[data-step="1"] .circle {
  animation: pulse 1.5s infinite;
}

.timeline-container.expanded .timeline-line {
  left: 200px; /* Adjust to ensure the line doesn't go through the image */
}

/* .timeline-container.main .timeline-step[data-step="1"],
.timeline-container.main .timeline-step[data-step="2"],
.timeline-container.main .timeline-step[data-step="3"] {
  background-color: rgba(21, 145, 222, 0.118); /* Blue shading */
  /* border-radius: 8px;
  padding: 10px;
} */

/* .timeline-container.main .timeline-step[data-step="4"],
.timeline-container.main .timeline-step[data-step="5"],
.timeline-container.main .timeline-step[data-step="6"],
.timeline-container.main .timeline-step[data-step="7"],
.timeline-container.main .timeline-step[data-step="8"] {
  background-color: rgba(71, 146, 226, 0.824); /* Lighter blue shading */
  /* border-radius: 8px;
  padding: 10px;
} */

  </style>
</head>
<body>
  <h1>Project Pipeline (Pre-Award to Project Close)</h1>

  

  <!-- Main Timeline -->
  <div class="timeline-container main">
    <div class="timeline-line"></div>
    <!-- Seven nodes -->
     
     
    <div class="timeline-step" data-step="1">
      <div class="triangle" data-text="Lead"></div>
      <div class="circle" style="background-color: var(--primary-color-3b);">1.1</div>
      <div class="timeline-popup-above">${titles[0]}</div>
      <div class="timeline-popup-below">Opportunity Manager identifies an Opportunity and suitable Project Leader(s)</div>
    </div>
    <div class="timeline-step" data-step="2">
      <div class="triangle" data-text="Confirmed"></div>
      <div class="circle" style="background-color: var(--primary-color-4);">1.2</div>
      <div class="timeline-popup-above">${titles[1]}</div>
      <div class="timeline-popup-below">Opportunity Manager works with assigned Project Leader and Financial Analyst hold suitable Staff.</div>
    </div>
    <div class="timeline-step" data-step="3">
      <div class="triangle" data-text="High-Confidence"></div>
      <div class="circle" style="background-color: var(--primary-color-4);">1.3</div>
      <div class="timeline-popup-above">${titles[2]}</div>
      <div class="timeline-popup-below">Opportunity Manager works with Finacial Analyst and Business Partners to acquire Costpoint number.</div>
    </div>
    <div class="timeline-step" data-step="4">
      <div class="triangle" data-text="Awarded" ></div>
      <div class="circle" style="background-color: var(--primary-color-1a);">2.1</div>
      <div class="timeline-popup-above">${titles[3]}</div>
      <div class="timeline-popup-below">Project Leaders, People Leaders and Staff are in regular communication. Staff are held to an Opportunity.</div>
    </div>
    <div class="timeline-step" data-step="5">
      <div class="circle" style="background-color: var(--primary-color-1b);">2.2</div>
      <div class="timeline-popup-above">${titles[4]}</div>
      <div class="timeline-popup-below">Project Leaders, People Leaders and Staff are in regular communication.</div>
    </div>
    <div class="timeline-step" data-step="6">
      <div class="circle" style="background-color: var(--primary-color-1c);">2.3</div>
      <div class="timeline-popup-above">${titles[5]}</div>
      <div class="timeline-popup-below">Project Leaders, People Leaders and Staff are in regular communication.</div>
    </div>
    <div class="timeline-step" data-step="7">
      <div class="circle" style="background-color: var(--primary-color-1d);">2.4</div>
      <div class="timeline-popup-above">${titles[6]}</div>
      <div class="timeline-popup-below">Project Leaders, People Leaders and Staff are in regular communication.</div>
    </div>
    <div class="timeline-step" data-step="8">
      <div class="circle"style="background-color: var(--primary-color-1d);">2.5</div>
      <div class="timeline-popup-above">${titles[7]}</div>
      <div class="timeline-popup-below">Project Leaders close out project, Staff are unheld and respective People Leaders are notified of the project completion.</div>
      <div class="triangle" data-text="Project Close"></div>
 
    </div>   
  </div>

   <!-- Overlay -->
   <div id="overlay" class="overlay">
    <div class="overlay-content">
      <span class="close-btn" onclick="closeOverlay()">&times;</span>
      <div id="overlay-text"></div>
    </div>
  </div>

  <!-- Expandable Timelines -->
   <!-- Green Timeline -->
<div class="timeline-container collapsed">
  <div class="timeline-line"></div>
  <div class="image-container" style="padding-right: 20px;">
    <div class="image-title">Staff</div>
    <img src="staff.jpg" alt="Staff">
  </div>
  <div class="timeline-step" data-step="1">
    <div class="circle">1.1</div>
    <div class="timeline-popup-above">${titles[0]}</div>
    <div class="timeline-popup-below">Details for Green Step 1</div>
  </div>
  <div class="timeline-step" data-step="2">
    <div class="circle">1.2</div>
    <div class="timeline-popup-above">${titles[1]}</div>
    <div class="timeline-popup-below">Details for Green Step 2</div>
  </div>
  <div class="timeline-step" data-step="3">
    <div class="circle">1.3</div>
    <div class="timeline-popup-above">${titles[2]}</div>
    <div class="timeline-popup-below">Details for Green Step 3</div>
  </div>
  <div class="timeline-step" data-step="4">
    <div class="circle">2.1</div>
    <div class="timeline-popup-above">${titles[3]}</div>
    <div class="timeline-popup-below">Details for Green Step 4</div>
  </div>
  <div class="timeline-step" data-step="5">
    <div class="circle">2.2</div>
    <div class="timeline-popup-above">${titles[4]}</div>
    <div class="timeline-popup-below">Details for Green Step 5</div>
  </div>
  <div class="timeline-step" data-step="6">
    <div class="circle">2.3</div>
    <div class="timeline-popup-above">${titles[5]}</div>
    <div class="timeline-popup-below">Details for Green Step 6</div>
  </div>
  <div class="timeline-step" data-step="7">
    <div class="circle">2.4</div>
    <div class="timeline-popup-above">${titles[6]}</div>
    <div class="timeline-popup-below">Details for Green Step 7</div>
  </div>
  <div class="timeline-step" data-step="8">
    <div class="circle">2.5</div>
    <div class="timeline-popup-above">${titles[7]}</div>
    <div class="timeline-popup-below">Details for Green Step 8</div>
  </div>
</div>

<!-- Red Timeline -->
<div class="timeline-container collapsed">
  <div class="timeline-line"></div>
  <div class="image-container">
    <div class="image-title">People Leader (GL, DM)</div>
    <img src="gl.jpg" alt="People Leader (GL, DM)">
  </div>
  <div class="timeline-step" data-step="1">
    <div class="circle">1.1</div>
    <div class="timeline-popup-above">${titles[0]}</div>
    <div class="timeline-popup-below">Details for Red Step 1</div>
  </div>
  <div class="timeline-step" data-step="2">
    <div class="circle">1.2</div>
    <div class="timeline-popup-above">${titles[1]}</div>
    <div class="timeline-popup-below">Details for Red Step 2</div>
  </div>
  <div class="timeline-step" data-step="3">
    <div class="circle">1.3</div>
    <div class="timeline-popup-above">${titles[2]}</div>
    <div class="timeline-popup-below">Details for Red Step 3</div>
  </div>
  <div class="timeline-step" data-step="4">
    <div class="circle">2.1</div>
    <div class="timeline-popup-above">${titles[3]}</div>
    <div class="timeline-popup-below">Details for Red Step 4</div>
  </div>
  <div class="timeline-step" data-step="5">
    <div class="circle">2.2</div>
    <div class="timeline-popup-above">${titles[4]}</div>
    <div class="timeline-popup-below">Details for Red Step 5</div>
  </div>
  <div class="timeline-step" data-step="6">
    <div class="circle">2.3</div>
    <div class="timeline-popup-above">${titles[5]}</div>
    <div class="timeline-popup-below">Details for Red Step 6</div>
  </div>
  <div class="timeline-step" data-step="7">
    <div class="circle">2.4</div>
    <div class="timeline-popup-above">${titles[6]}</div>
    <div class="timeline-popup-below">Details for Red Step 7</div>
  </div>
  <div class="timeline-step" data-step="8">
    <div class="circle">2.5</div>
    <div class="timeline-popup-above">${titles[7]}</div>
    <div class="timeline-popup-below">Details for Red Step 8</div>
  </div>
</div>

<!-- Blue Timeline -->
<div class="timeline-container collapsed">
  <div class="timeline-line"></div>
  <div class="image-container">
    <div class="image-title">Project Leader (PL)</div>
    <img src="pl.jpg" alt="Project Leader">
  </div>
  <div class="timeline-step" data-step="1">
    <div class="circle">1.1</div>
    <div class="timeline-popup-above">${titles[0]}</div>
    <div class="timeline-popup-below">Details for Blue Step 1</div>
  </div>
  <div class="timeline-step" data-step="2">
    <div class="circle">1.2</div>
    <div class="timeline-popup-above">${titles[1]}</div>
    <div class="timeline-popup-below">Details for Blue Step 2</div>
  </div>
  <div class="timeline-step" data-step="3">
    <div class="circle">1.3</div>
    <div class="timeline-popup-above">${titles[2]}</div>
    <div class="timeline-popup-below">Details for Blue Step 3</div>
  </div>
  <div class="timeline-step" data-step="4">
    <div class="circle">2.1</div>
    <div class="timeline-popup-above">${titles[3]}</div>
    <div class="timeline-popup-below">Details for Blue Step 4</div>
  </div>
  <div class="timeline-step" data-step="5">
    <div class="circle">2.2</div>
    <div class="timeline-popup-above">${titles[4]}</div>
    <div class="timeline-popup-below">Details for Blue Step 5</div>
  </div>
  <div class="timeline-step" data-step="6">
    <div class="circle">2.3</div>
    <div class="timeline-popup-above">${titles[5]}</div>
    <div class="timeline-popup-below">Details for Blue Step 6</div>
  </div>
  <div class="timeline-step" data-step="7">
    <div class="circle">2.4</div>
    <div class="timeline-popup-above">${titles[6]}</div>
    <div class="timeline-popup-below">Details for Blue Step 7</div>
  </div>
  <div class="timeline-step" data-step="8">
    <div class="circle">2.5</div>
    <div class="timeline-popup-above">${titles[7]}</div>
    <div class="timeline-popup-below">Details for Blue Step 8</div>
  </div>
</div>

<!-- Orange Timeline -->
<div class="timeline-container collapsed">
  <div class="timeline-line"></div>
  <div class="image-container">
    <div class="image-title">Business Leader (FA)</div>
    <img src="bl.jpg" alt="Business Leader (Financial Analysts)">
  </div>
  <div class="timeline-step" data-step="1">
    <div class="circle">1.1</div>
    <div class="timeline-popup-above">${titles[0]}</div>
    <div class="timeline-popup-below">Details for Orange Step 1</div>
  </div>
  <div class="timeline-step" data-step="2">
    <div class="circle">1.2</div>
    <div class="timeline-popup-above">${titles[1]}</div>
    <div class="timeline-popup-below">Details for Orange Step 2</div>
  </div>
  <div class="timeline-step" data-step="3">
    <div class="circle">1.3</div>
    <div class="timeline-popup-above">${titles[2]}</div>
    <div class="timeline-popup-below">Details for Orange Step 3</div>
  </div>
  <div class="timeline-step" data-step="4">
    <div class="circle">2.1</div>
    <div class="timeline-popup-above">${titles[3]}</div>
    <div class="timeline-popup-below">Details for Orange Step 4</div>
  </div>
  <div class="timeline-step" data-step="5">
    <div class="circle">2.2</div>
    <div class="timeline-popup-above">${titles[4]}</div>
    <div class="timeline-popup-below">Details for Orange Step 5</div>
  </div>
  <div class="timeline-step" data-step="6">
    <div class="circle">2.3</div>
    <div class="timeline-popup-above">${titles[5]}</div>
    <div class="timeline-popup-below">Details for Orange Step 6</div>
  </div>
  <div class="timeline-step" data-step="7">
    <div class="circle">2.4</div>
    <div class="timeline-popup-above">${titles[6]}</div>
    <div class="timeline-popup-below">Details for Orange Step 7</div>
  </div>
  <div class="timeline-step" data-step="8">
    <div class="circle">2.5</div>
    <div class="timeline-popup-above">${titles[7]}</div>
    <div class="timeline-popup-below">Details for Orange Step 8</div>
  </div>
</div>
  
    <script>

      // Toggle expanded timelines from main timeline
      document.querySelectorAll('.timeline-container.main .timeline-step').forEach(step => {
        step.addEventListener('click', () => {
          const expandedTimelines = document.querySelectorAll('.timeline-container:not(.main)');
          expandedTimelines.forEach(timeline => {
            timeline.classList.add('expanded');
            timeline.classList.remove('collapsed');
            applyIncrementalOpacity(timeline); 
          });
        });
      });
    
      // Show popups for corresponding nodes in expanded timelines
      document.querySelectorAll('.timeline-container:not(.main) .timeline-step').forEach(step => {
        step.addEventListener('click', (e) => {
          e.stopPropagation();
          const stepNumber = step.getAttribute('data-step');
          document.querySelectorAll(`.timeline-container.expanded .timeline-step[data-step="${stepNumber}"]`).forEach(matchingStep => {
            matchingStep.classList.toggle('show');
          });
          const container = step.closest('.timeline-container');
          document.querySelectorAll('.timeline-container').forEach(c => c.classList.remove('foreground'));
          container.classList.add('foreground');
        });
      });
    
      // Show overlay when clicking on a timeline step
      document.querySelectorAll('.timeline-step').forEach(step => {
        step.addEventListener('click', function() {
          const overlay = document.getElementById('overlay');
          const overlayText = document.getElementById('overlay-text');
          const popupAbove = this.querySelector('.timeline-popup-above').innerHTML;
          const popupBelow = this.querySelector('.timeline-popup-below').innerHTML;
          overlayText.innerHTML = `<h3>${popupAbove}</h3><p>${popupBelow}</p>`;
          overlay.style.display = 'flex';
        });
      });
    
      // Close overlay and collapse timelines
      function closeOverlay() {
        document.getElementById('overlay').style.display = 'none';
        const expandedTimelines = document.querySelectorAll('.timeline-container.expanded');
        expandedTimelines.forEach(timeline => {
          timeline.classList.add('collapsed');
          timeline.classList.remove('expanded');
        });
      }
    
      // Remove foreground when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.timeline-container') && !e.target.closest('#overlay')) {
          document.querySelectorAll('.timeline-container').forEach(container => {
            container.classList.remove('foreground');
          });
        }
      });
      
      // Stop pulse animation on click
      document.querySelector('.timeline-container.main .timeline-step[data-step="1"] .circle').addEventListener('click', function() {
        this.style.animation = 'none';
      });     
      
     // Titles for top pop-up
      const titles = [
        "1.1 Identify Opportunity",
        "1.2 Mature Opportunity to High Confidence",
        "1.3 Manage High Confidence Opportunity",
        "2.1 Launch Project",
        "2.2 Manage Project",
        "2.3 Report Progress",
        "2.4 Deliver Results",
        "2.5 Close Project"
      ];

      // Function to assign titles to popups
      function assignTitles(container) {
        container.querySelectorAll('.timeline-step').forEach((step, index) => {
          const popupAbove = step.querySelector('.timeline-popup-above');
          if (popupAbove) {
            if (index < titles.length) {
              popupAbove.textContent = titles[index];
            } else {
              popupAbove.textContent = "Title not available";
            }
          }
        });
      }

      // Toggle expanded timelines from main timeline
      document.querySelectorAll('.timeline-container.main .timeline-step').forEach(step => {
        step.addEventListener('click', () => {
          const expandedTimelines = document.querySelectorAll('.timeline-container:not(.main)');
          expandedTimelines.forEach(timeline => {
            timeline.classList.add('expanded');
            timeline.classList.remove('collapsed');
            assignTitles(timeline); // Reassign titles for expanded timelines

            // Assign instructional text relative to persona
            if (timeline.querySelector('.image-title').textContent === 'Staff') {
              updatePopupBelowContent(timeline, 'green');
            } 
            else if (timeline.querySelector('.image-title').textContent === 'People Leader (GL, DM)') {
              updatePopupBelowContent(timeline, 'red');
            } 
            else if (timeline.querySelector('.image-title').textContent === 'Project Leader (PL)') {
              updatePopupBelowContent(timeline, 'blue');
            } 
            else if (timeline.querySelector('.image-title').textContent === 'Business Leader (FA)') {
              updatePopupBelowContent(timeline, 'orange');
            }
          });
        });
      });

      // Assign titles on initial load for main timeline
      document.addEventListener('DOMContentLoaded', () => {
        const mainTimeline = document.querySelector('.timeline-container.main');
        if (mainTimeline) {
          assignTitles(mainTimeline);
        }
      });

      // // Function to apply incremental opacity to the last four nodes
      // function applyIncrementalOpacity(timeline) {
      //   const steps = Array.from(timeline.querySelectorAll('.timeline-step'));
      //   const lastFiveSteps = steps.slice(-5); // Get the last five steps

      //   // Clear existing opacity classes
      //   steps.forEach(step => {
      //     step.classList.remove('opacity-1', 'opacity-2', 'opacity-3', 'opacity-4', 'opacity-5');
      //   });

      //   // Apply incremental opacity classes
      //   lastFiveSteps.forEach((step, index) => {
      //     step.classList.add(`opacity-${index + 1}`);
      //   });
      // }

      const popupBelowData = {
        green: [
          "Staff should update skills and their tech stature to be able to take on new projects. Staff should also be proactive in identifying project opportunities.",
          "Staff require support from their People Leader (GL, DM) to proactively identify project opportunites. Staff need to be proactive and establish clear channels of communication with their GLs.",
          "Staff need to be proactive and establish clear channels of communication with Project Leaders so the project scope and commitment is clear.",
          "When Held to a project, Staff must be clear on roles and responsibilities.",
          "When Held to a project, Staff must be clear on how much of their time is allocated to a project.",
          "Staff should request feedback from the Project or Task Leader on their performance, particularly if none is given.",
          "Staff should take the iniative and request advance notice from a Project Leader on a project close-out timeline so they have adequate time to plan a transition to a new project, with the guidance of their People Leader.",
          "Staff should ensure that they deliver on their project commitments in advance of project close-out."
        ],
        blue: [
          "The Project Leader requests project details from the Opportunity Manager.",
          "The Project Leader partners with Business Leaders on project budget, resource costing and ODCs.",
          "The Project Leader defines roles and skill sets and assign staff to relevant opportunities.",
          "The Project Leader tracks any and all financial updates and support any necessary staffing adjustments.",
          "The Project Leader communicates any pertinent changes in project scope, schedule or other project issues.",
          "The Project Leader requests reports on staffing performance from other leaders within the team, including staff development plans and resource management.",
          "The Project Leader requests support from Business Leaders to ensure effective project close-out and ensure sponsor requirements have been met.",
          "The Project Leader communicates to People Leaders and Staff on project close-out to ensure adequate time for staff transition plans to new projects."
        ],
        red: [
          "People Leaders request project labor details from the Project Leader.",
          "People Leaders should assist staff in finding project opportunities that foster their growth and development.",
          "People Leaders should provide Opportunity Managers and Project Leaders with insights into staff skills and capabilities.",
          "People Leaders should request updates from Project Leaders on project status and any changes in project scope.",
          "People Leaders should request feedback on staff performance from Project Leaders.",
          "People Leaders manage coverage and availability across all projects.",
          "People Leaders should request support from Project Leaders to ensure effective project close-out and ensure sponsor requirements have been met.",
          "People Leaders should assist staff with finding new work, advocating for their development and ensuring good-faith collaboration with Project Leaders."
        ],
        orange: [
          "Business Leaders to collaborate with Project Leaders staff plan for pricing purposes",
          "Business Leaders request ODC from Project Leaders for pricing purposes and support on pricing and estimates.",
          "Business Leaders should add project numbers and expenses codes.",
          "Business Leaders should request updates from Project Leaders on project status and any changes in project scope.",
          "Business Leaders provide guidance on project execution (burn rates, ramp-up/down, etc.).",
          "Business Leaders should request notification of any changes in staffing allocations or project changes.",
          "Business Leaders should request details on any trailing costs from Project Leaders.",
          "Business Leaders should assist Project Leaders achieve a soft landing for staff and ensure that all project requirements have been met."
        ]
      };

      function updatePopupBelowContent(timeline, type) {
        const steps = Array.from(timeline.querySelectorAll('.timeline-step'));
        const data = popupBelowData[type];

        steps.forEach((step, index) => {
          const popupBelow = step.querySelector('.timeline-popup-below');
          if (popupBelow && data[index]) {
            popupBelow.textContent = data[index];
          }
        });
      }
  </script>
  </body>
  </html>